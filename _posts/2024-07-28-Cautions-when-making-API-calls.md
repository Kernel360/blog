---
layout: post  
title: `Cautions when making API calls`
author: `양하연`
categories: `기술세미나`
banner:
  image: `썸네일로 넣고 싶은 이미지 링크`
  background: "#000"
  height: "100vh"
  min_height: "38vh"
  heading_style: "font-size: 4.25em; font-weight: bold; text-decoration: underline"
  tags: [`api`,`고유한id`]
---

안녕하세요, Kernel360 FE 1기 크루 양하연 입니다. 오늘 포스팅에서는 외부 api호출하실 때에 주의하실 점에 대해서 제가 이번에 참여한 프로젝트를 예시로 들어 설명드리려고 합니다.

지난 주, 저는 해커톤을 진행하면서 api에 대한 get 호출을 통해 받아온 data를 이리저리 가공하는, **api 로직을 구현하는 업무**를 맡았었습니다.
저는 아래 api 호출문을 이용했습니다.

### 📣자세한 상황설명

![alt text](image.png)

GET /riot/account/v1/accounts/by-riot-id/{gameName}/{tagLine}

위 api호출문을 잠시 설명하자면, lol서버에 있는 아이디에 대한 해시값을 리턴하는 호출문이었습니다.

lol이라는 게임서버에 유일무이하게 존재하는 '아이디'에 대한 해시값을 response body로 출력하는 api문이었기 떄문에, 유일무이한 값이라고 생각했습니다.

그런데 분명히 같은 팀원분이 건네준 코드를 바탕으로 api 호출문을 실행하는데 자꾸만 리턴값인 puuid값을 찾을 수 없다는 에러가 뜨는 것이었습니다.

### 🤔에러의 원인을 찾기 위한 삽질..

github으로 협업을 하고 있는 프로젝트였기 때문에,
에러의 원인을 찾기까지 분명 '코드'에 문제가 있을 것이다 라는 추측하에 코드에서 다른 점을 찾아내고자 했습니다.

동일한 코드를 사용하는 환경을 만들기 위해,
최신 코드가 커밋된 github의 코드를 git clone도 시도해보고, yarn과 관련된 환경설정 파일인 .pnp.cjs파일도 지웠다가 다시 설치해보고, 다른 노트북으로 git clone을 다시한번 받아보기도 했습니다.

### ❗️과연 원인은..?

수많은 삽질끝에 찾아낸 원인은.,,,다른 api key를 이용해 api요청을 하고 있었던게 문제였던 것입니다!

당연히 다른 api key를 사용하면 리턴하는 값이 다르지 않냐...라는 물음이 드실 수도 있지만 api key는 말그대로 호출을 하기 위한 계정일뿐, '아이디'라는 유일무이한 값에 대한 해시값은 동일해야하는 것 아닐까? 라는 명제가 일반적이라고 생각하는게 일반적인 논리라고 생각했었습니다.

뭐 그게 성립하지 않는다는 것을 지금 깨달았지만요!

### 🔥결론..

혹시 저와같이, api 로직을 작성하는 협업 프로젝트에 참여하시는 분들 중, 다른 동료와 코드가 정말 똑같은데도 자꾸 코드 에러가 나는 상황이시라면,

**혹시 api 호출문에서 서로 다른 api key를 이용해 호출하고 있는 건 아닌지!!**를 꼭 확인해보시기 바랍니다.
